<mat-card class="chart-widget">
  <mat-card-header class="widget-header">
    <div class="header-content">
      <mat-icon class="chart-type-icon">{{ getChartTypeIcon() }}</mat-icon>
      <div class="title-section">
        <mat-card-title>{{ widget.title }}</mat-card-title>
        <mat-card-subtitle *ngIf="widget.description">
          {{ widget.description }}
        </mat-card-subtitle>
      </div>
    </div>
    
    <div class="header-actions">
      <button 
        mat-icon-button
        [matMenuTriggerFor]="widgetMenu"
        class="menu-btn">
        <mat-icon>more_vert</mat-icon>
      </button>
    </div>
  </mat-card-header>

  <mat-card-content class="chart-content">
    <!-- Loading State -->
    <div *ngIf="loading()" class="loading-state">
      <div class="loading-spinner"></div>
      <p>Loading chart data...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error() && !loading()" class="error-state">
      <mat-icon>error_outline</mat-icon>
      <p>{{ error() }}</p>
      <button 
        mat-button 
        color="primary"
        (click)="loadChartData()">
        Retry
      </button>
    </div>

    <!-- Chart Canvas -->
    <div 
      *ngIf="!loading() && !error()" 
      class="chart-container">
      <canvas 
        #chartCanvas
        class="chart-canvas">
      </canvas>
    </div>

    <!-- Configuration Hint -->
    <div 
      *ngIf="!loading() && !error() && !hasData()" 
      class="config-hint">
      <mat-icon>settings</mat-icon>
      <p>Chart needs configuration</p>
      <button 
        mat-button 
        color="primary"
        (click)="onEdit()">
        Configure Chart
      </button>
    </div>
  </mat-card-content>
</mat-card>

<!-- Widget Menu -->
<mat-menu #widgetMenu="matMenu">
  <button mat-menu-item (click)="onEdit()">
    <mat-icon>edit</mat-icon>
    <span>Edit</span>
  </button>
  <button mat-menu-item (click)="onDuplicate()">
    <mat-icon>content_copy</mat-icon>
    <span>Duplicate</span>
  </button>
  <mat-divider></mat-divider>
  <button mat-menu-item (click)="onDelete()" class="delete-action">
    <mat-icon>delete</mat-icon>
    <span>Delete</span>
  </button>
</mat-menu>
