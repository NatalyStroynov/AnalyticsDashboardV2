<div class="chart-config-overlay">
  <div class="chart-config-panel">
    <div class="panel-header">
      <h2>Chart Configuration</h2>
      <button 
        mat-icon-button
        (click)="onCancel()"
        class="close-btn">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <div class="panel-content">
      <mat-tab-group>
        <!-- Basic Configuration -->
        <mat-tab label="Basic">
          <div class="tab-content">
            <!-- Chart Title -->
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Chart Title</mat-label>
              <input 
                matInput
                [value]="formWidget().title"
                (input)="onTitleChange($any($event.target).value)"
                placeholder="Enter chart title">
            </mat-form-field>

            <!-- Chart Description -->
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Description (Optional)</mat-label>
              <textarea 
                matInput
                [value]="formWidget().description || ''"
                (input)="onDescriptionChange($any($event.target).value)"
                placeholder="Enter chart description"
                rows="2">
              </textarea>
            </mat-form-field>

            <!-- Chart Type -->
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Chart Type</mat-label>
              <mat-select 
                [value]="formWidget().type"
                (selectionChange)="onChartTypeChange($event.value)">
                <mat-option 
                  *ngFor="let type of chartTypes; trackBy: trackChartType"
                  [value]="type.value">
                  <div class="chart-type-option">
                    <mat-icon>{{ type.icon }}</mat-icon>
                    <span>{{ type.label }}</span>
                  </div>
                </mat-option>
              </mat-select>
            </mat-form-field>

            <!-- Data Source -->
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Data Source</mat-label>
              <mat-select 
                [value]="formWidget().config.dataSource"
                (selectionChange)="onDataSourceChange($event.value)">
                <mat-option 
                  *ngFor="let source of dataSourceOptions"
                  [value]="source.value">
                  {{ source.label }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </mat-tab>

        <!-- Data Configuration -->
        <mat-tab label="Data">
          <div class="tab-content">
            <!-- X-Axis Configuration -->
            <div class="field-group">
              <h4>X-Axis (Horizontal)</h4>
              
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Field</mat-label>
                <mat-select 
                  [value]="formWidget().config.xAxis.field"
                  (selectionChange)="onXAxisChange($event.value)">
                  <mat-option value="">Select field...</mat-option>
                  <mat-option 
                    *ngFor="let field of availableFields(); trackBy: trackField"
                    [value]="field">
                    {{ field }}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Label (Optional)</mat-label>
                <input 
                  matInput
                  [value]="formWidget().config.xAxis.label || ''"
                  (input)="onXAxisLabelChange($any($event.target).value)"
                  placeholder="Custom axis label">
              </mat-form-field>
            </div>

            <!-- Y-Axis Configuration -->
            <div class="field-group">
              <h4>Y-Axis (Vertical)</h4>
              
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Field</mat-label>
                <mat-select 
                  [value]="formWidget().config.yAxis.field"
                  (selectionChange)="onYAxisChange($event.value)">
                  <mat-option value="">Select field...</mat-option>
                  <mat-option 
                    *ngFor="let field of availableFields(); trackBy: trackField"
                    [value]="field">
                    {{ field }}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Label (Optional)</mat-label>
                <input 
                  matInput
                  [value]="formWidget().config.yAxis.label || ''"
                  (input)="onYAxisLabelChange($any($event.target).value)"
                  placeholder="Custom axis label">
              </mat-form-field>
            </div>

            <!-- Aggregation -->
            <div class="field-group">
              <h4>Aggregation</h4>
              
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Aggregation Type</mat-label>
                <mat-select 
                  [value]="formWidget().config.aggregation"
                  (selectionChange)="onAggregationChange($event.value)">
                  <mat-option 
                    *ngFor="let agg of aggregationTypes; trackBy: trackAggregationType"
                    [value]="agg.value">
                    {{ agg.label }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </mat-tab>

        <!-- Styling (Future Enhancement) -->
        <mat-tab label="Styling" disabled>
          <div class="tab-content">
            <p class="disabled-tab-message">
              Styling options will be available in a future update.
            </p>
          </div>
        </mat-tab>
      </mat-tab-group>
    </div>

    <div class="panel-actions">
      <button 
        mat-button
        (click)="onCancel()"
        class="cancel-btn">
        Cancel
      </button>
      <button 
        mat-raised-button
        color="primary"
        (click)="onSave()"
        [disabled]="!isConfigurationValid()"
        class="save-btn">
        Save Configuration
      </button>
    </div>
  </div>
</div>
