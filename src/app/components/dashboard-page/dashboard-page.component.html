<mat-sidenav-container class="dashboard-container">
  <!-- Filters Sidebar -->
  <mat-sidenav 
    #sidenav 
    mode="side" 
    [opened]="sidenavOpened()"
    position="start"
    class="filters-sidenav">
    <app-filters-panel></app-filters-panel>
  </mat-sidenav>

  <!-- Main Content -->
  <mat-sidenav-content class="dashboard-content">
    <!-- Toolbar -->
    <mat-toolbar class="dashboard-toolbar">
      <button 
        mat-icon-button 
        (click)="toggleSidenav()"
        matTooltip="Toggle Filters">
        <mat-icon>filter_list</mat-icon>
      </button>

      <app-dashboard-selector></app-dashboard-selector>

      <span class="toolbar-spacer"></span>

      <button 
        mat-raised-button 
        color="primary"
        (click)="addNewWidget()"
        class="add-widget-btn">
        <mat-icon>add</mat-icon>
        Add Chart
      </button>
    </mat-toolbar>

    <!-- Dashboard Content -->
    <div class="dashboard-main">
      <div 
        *ngIf="hasWidgets(); else emptyState"
        class="dashboard-grid"
        cdkDropList
        (cdkDropListDropped)="onWidgetDrop($event)">
        
        <div 
          *ngFor="let widget of widgets(); trackBy: trackWidget"
          class="widget-container"
          cdkDrag>
          <app-chart-widget
            [widget]="widget"
            [filters]="filters()"
            (edit)="editWidget($event)"
            (delete)="onWidgetDelete($event)"
            (duplicate)="onWidgetDuplicate($event)">
          </app-chart-widget>
        </div>
      </div>

      <!-- Empty State -->
      <ng-template #emptyState>
        <div class="empty-state">
          <mat-icon>insert_chart</mat-icon>
          <h2>No Charts Yet</h2>
          <p>Start building your dashboard by adding your first chart</p>
          <button 
            mat-raised-button 
            color="primary"
            (click)="addNewWidget()"
            class="empty-state-btn">
            <mat-icon>add</mat-icon>
            Add Your First Chart
          </button>
        </div>
      </ng-template>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>

<!-- Chart Configuration Panel -->
<app-chart-config
  *ngIf="showChartConfig()"
  [widget]="selectedWidget()!"
  (save)="onWidgetConfigSave($event)"
  (cancel)="onWidgetConfigCancel()">
</app-chart-config>
