<!-- Main Dashboard Layout -->
<div class="dashboard-layout">
  <!-- Top Navigation Bar -->
  <div class="top-nav">
    <div class="nav-left">
      <!-- Dashboard Selector Dropdown -->
      <div class="dashboard-selector-container" [class.open]="showDashboardDropdown">
        <button class="dashboard-selector" (click)="toggleDashboardDropdown()">
          {{ currentDashboard.name }}
          <span class="material-icons">keyboard_arrow_down</span>
        </button>
        
        <div class="dashboard-dropdown" *ngIf="showDashboardDropdown">
          <div class="dropdown-header">
            <button class="create-dashboard-btn" (click)="showCreateDashboardModal()">
              <span class="material-icons">add</span>
              Create New Dashboard
            </button>
          </div>
          
          <div class="dashboard-list">
            <div *ngFor="let dashboard of dashboards" 
                 class="dashboard-item" 
                 [class.active]="dashboard.id === currentDashboard.id"
                 (click)="selectDashboard(dashboard.id)">
              <div class="dashboard-info">
                <div class="dashboard-name">{{ dashboard.name }}</div>
                <div class="dashboard-type">DBS - {{ dashboard.name }}</div>
              </div>
              <div class="dashboard-actions">
                <button class="action-btn" (click)="editDashboard(dashboard.id); $event.stopPropagation()">
                  <span class="material-icons">edit</span>
                </button>
                <button class="action-btn" (click)="deleteDashboard(dashboard.id); $event.stopPropagation()">
                  <span class="material-icons">delete</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="nav-right">
      <button class="nav-btn" (click)="showDataSources()">
        <span class="nav-btn-text">Data Sources</span>
        <span class="material-icons">keyboard_arrow_down</span>
      </button>
      <button class="nav-btn filters-btn" (click)="toggleFiltersPanel()">
        <span class="material-icons">filter_list</span>
        <span class="nav-btn-text">Filters</span>
      </button>
    </div>
  </div>

  <!-- Main Content Area -->
  <div class="main-content" [class.filters-open]="showFiltersPanel">
    <!-- Charts Grid -->
    <div class="charts-container">
      <div class="charts-grid" *ngIf="currentDashboard.charts.length > 0; else emptyState">
        <div *ngFor="let chart of currentDashboard.charts" class="chart-widget">
          <div class="widget-header">
            <h3 class="widget-title">{{ chart.title }}</h3>
            <div class="widget-menu">
              <button class="menu-btn" (click)="toggleChartMenu(chart.id)">
                <span class="material-icons">more_vert</span>
              </button>
              <div class="chart-menu" *ngIf="activeChartMenu === chart.id">
                <button (click)="editChart(chart.id)">Edit Chart</button>
                <button (click)="duplicateChart(chart.id)">Duplicate</button>
                <button (click)="deleteChart(chart.id)">Delete</button>
              </div>
            </div>
          </div>
          <div class="widget-content">
            <canvas 
              [id]="chart.id" 
              class="chart-canvas"
              appChart
              [chartType]="chart.type"
              [chartData]="chart.data"
              [chartOptions]="chart.options">
            </canvas>
          </div>
        </div>
      </div>

      <ng-template #emptyState>
        <div class="empty-dashboard">
          <span class="material-icons">assessment</span>
          <h3>No visualizations yet</h3>
          <p>Add your first chart to get started</p>
        </div>
      </ng-template>
      
      <!-- Add Chart Button -->
      <button class="add-chart-btn" (click)="showChartConfigModal()">
        <span class="material-icons">add</span>
      </button>
    </div>

    <!-- Filters Side Panel -->
    <div class="filters-panel" [class.open]="showFiltersPanel">
      <div class="panel-header">
        <h3>FILTERS</h3>
        <button class="close-panel" (click)="toggleFiltersPanel()">
          <span class="material-icons">close</span>
        </button>
      </div>
      
      <div class="filters-content">
        <div class="filter-row" *ngFor="let filter of activeFilters; let i = index">
          <div class="filter-group">
            <div class="form-row">
              <label>Field Name</label>
              <input type="text" [(ngModel)]="filter.field" placeholder="Select field">
            </div>
            <div class="form-row">
              <label>Operator</label>
              <select [(ngModel)]="filter.operator">
                <option value="includes">Includes...</option>
                <option value="equals">=</option>
                <option value="greater">></option>
                <option value="less"><</option>
              </select>
            </div>
            <div class="form-row">
              <label>Value</label>
              <input type="text" [(ngModel)]="filter.value" placeholder="Enter value">
            </div>
          </div>
          <button class="remove-filter" (click)="removeFilter(i)">
            <span class="material-icons">delete</span>
          </button>
        </div>
        
        <button class="add-filter-btn" (click)="addNewFilter()">
          <span class="material-icons">add</span>
          Add New Clause
        </button>
        
        <div class="filter-actions">
          <button class="apply-btn" (click)="applyFilters()">Apply</button>
        </div>
      </div>
    </div>
  </div>
</div>

